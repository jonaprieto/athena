# Athena [![Build Status](https://travis-ci.org/jonaprieto/athena.svg?branch=master)](https://travis-ci.org/jonaprieto/athena) [![DOI](https://zenodo.org/badge/85713337.svg)](https://zenodo.org/badge/latestdoi/85713337)

![diagram]

**Athena** is a [Haskell][haskell] program that translates
proposition proofs generated by [Metis][metis] to [Agda][agda] code.

### Documentation

* [Reconstructing Propositional Proofs in Type Theory](https://github.com/jonaprieto/athena/files/1425065/Prieto-Cubides.-.2017.-.Reconstructing.Propositional.Proofs.in.Type.Theory.pdf)
* See our last [talk](https://github.com/jonaprieto/athena/raw/master/slides/Jonathan-Proof-Reconstruction.pdf) for a briefly introduction of this tool.

### Installing

Clone this repository:

```
$ git clone https://github.com/jonaprieto/athena.git
$ cd athena
$ make install
$ make install-libraries
```

Athena was tested with:

* GHC v8.0.2 and GHC v8.2.1
* [Agda][agda] v2.5.3
* [Metis][metis] v2.3 (release 20170810)
* \[optional\]: benefit of at least forty provers including Metis: [OnlineATPs][online-atps].

### Testing a small problem

In order to test the installation of Athena, you can try to reconstruct a simple proof.

First, let us write the problem $$\inline\{ p , q\} \vdash p \wedge q$$ in TPTP to generate the solution using [metis].

```
$ cat problem.tptp
fof(a1, axiom, p).
fof(a2, axiom, q).
fof(goal, conjecture, p & q).
```

To get the TSTP proof run the following command:

```
$ metis --show proof problem.tptp > problem.tstp
$ cat problem.tstp
...
fof(a1, axiom, (p)).
fof(a2, axiom, (q)).
fof(goal, conjecture, (p & q)).
fof(subgoal_0, plain, (p), inference(strip, [], [goal])).
...
    inference(simplify, [],
              [normalize_1_0, normalize_1_1, normalize_1_2])).
cnf(refute_1_0, plain, ($false),
    inference(canonicalize, [], [normalize_1_3])).
% SZS output end CNFRefutation for conj-01.tptp
```

Or if you are using [online-atps]:

```
$ online-atps --atp=metis problem.tptp > problem.tstp
```

Now, let us generate the Agda code using Athena:

```
$ athena problem.tstp
```

Remember that Athena named the Agda file with the same name of the TSTP solution:

```agda
$ cat problem.agda
...
-- Axioms.

a₁ : PropFormula
a₁ = p

a₂ : PropFormula
a₂ = q

-- Premises.

Γ : Ctxt
Γ = ∅ , a₁ , a₂

-- Conjecture.

goal : PropFormula
goal = (p ∧ q)

-- Subgoals.

subgoal₀ : PropFormula
subgoal₀ = p

subgoal₁ : PropFormula
subgoal₁ = (p ⇒ q)

-- Proof.

proof₀ : Γ ⊢ subgoal₀
proof₀ =
  (RAA
    (thm-simplify ⊥
      (assume {Γ = Γ} (¬ subgoal₀))
      (thm-canonicalize-axiom p
        (weaken-Δ₁
          (∅ , a₂ , ¬ subgoal₀)
          assume {Γ = ∅} a₁))))

proof₁ : Γ ⊢ subgoal₁
proof₁ =
  (RAA
    (thm-simplify ⊥
      (thm-canonicalize-axiom p
        (weaken-Δ₁
          (∅ , a₂ , ¬ subgoal₁)
          assume {Γ = ∅} a₁))
      (thm-simplify ⊥
        (thm-canonicalize ((¬ q) ∧ p)
          (assume {Γ = Γ} (¬ subgoal₁)))
        (thm-canonicalize-axiom q
          (weaken (¬ subgoal₁)
            assume {Γ = [ a₁ ]} a₂)))))

proof : Γ ⊢ goal
proof =
  ⇒-elim
    thm-strip
    (∧-intro proof₀ proof₁)
```

Finally, we type-check the proof. At this stage, we will assume you've already
installed successfully the libraries [agda-prop], and [agda-metis] and
[agda-stdlib] libraries.

```agda
$ agda problem.agda
```

If everything works as we expected, Agda will generate an interface file as
result of the type-checking. At the end, we should have four files: the TPTP
problem, the TSTP solution, the Agda proof-term, and the Agda interface file.

```
$ tree .
.
├── problem.agda
├── problem.iagda
├── problem.tptp
└── problem.tstp
```

### Testing more example

We have including a test-suite of at least eighty [problems].
To reconstruct all these proofs run the following command:

```
$ make reconstruct
```

To type-check the proofs:

```
$ make check
```

If anything didn't work as you expected, please report it
opening an [issue].


[diagram]: https://raw.githubusercontent.com/jonaprieto/athena/master/slides/diagram.png
[haskell]: http://www.haskell.org
[issue]: http://github.com/jonaprieto/athena/issues/new
[tstp]:    http://www.cs.miami.edu/~tptp/TPTP/QuickGuide/
[metis]:   http://github.com/gilith/metis
[agda]:    http://github.com/agda/agda
[agda-prop]: http://github.com/jonaprieto/agda-prop
[agda-metis]: http://github.com/jonaprieto/agda-metis
[agda-stdlib]: http://github.com/agda/agda-stdlib
[problems]: http://github.com/jonaprieto/prop-pack
[online-atps]: http://github.com/jonaprieto/online-atps
