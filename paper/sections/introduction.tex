
\documentclass[../main.tex]{subfiles}
\begin{document}

% ===================================================================

\section{Introduction}
\label{sec:introduction}

An automatic theorem prover (henceforth \ATP) is a program that
intends to prove conjectures from axioms and inference rules of some
logical system. In the last decades, \ATPs are fast becoming a key
instrument in different disciplines and real applications (\eg,
verifying a railway interlocking system, an operating-system kernel,
or a pseudo-random number generator for cryptography). Since some
programming errors have been found in these programs (see, for
example, \cite{Keller2013,Bohme2011,Fleury2014}), researchers and
users from academy and industry have shown an increased interest to
\emph{formally} prove the validity of \ATPs' results.

In order to give confidence to the \ATP users, many of these systems
have started to include in their outputs the full derivations
associated to the proved theorems. However, existing research
recognizes that in many cases these proofs encode non-trivial
reasoning hard to reconstruct and therefore hard to
verify~\cite{paulson2007source,Keller2013}.

Proof-reconstruction addresses this problem. It becomes in mostly
cases a reverse engineering task to verify the prover reasoning. That
usually happens when the reconstruction is made by another and not by
the developers of the \ATP. The presentation of the proofs generated
by the prover plays an important role in proof-reconstruction. To
verify such a proof, it is convenient to have it in a consistent
format, that is, a full script describing the derivation step-by-step
with  exhaustive details and without ambiguities. For example, for
classical propositional logic (henceforth \CPL) from a list of at
least forty \ATPs---available from the Web service
\name{SystemOnTPTP} of the TPTP World\footnote{\url{http://www.cs.miami.edu/~tptp/}.}---just few of
them show their proofs.

One approach to address the proof-reconstruction problem is
justifying each inference rule of the \emph{source} system, the \ATP,
with a proof-assistant, the \emph{target} system. The target system
is the proof \emph{checker} in charge to verify the source system
reasoning.
These proof-assistants allow us to formalize the logical system used
in the proofs, \ie, logical constants, axioms, inference rules,
hypotheses, and theorems. A proof-reconstruction tool provides such
an integration, translating the derivation generated by the prover
into the formalism of the proof-assistant.

Previous studies have reported proof-reconstruction using
proof-assistants based on higher-order logic where the development is at a mature
stage~\cite{paulson2010three,hurlin07practical,kaliszyk2013}.
Another approaches has been proposed for proof-reconstructing based
on type theory in~\cite{Bezem2002,kanso2016light,Keller2013}.

We describe a formal reconstruction of proofs generated by the \Metis
prover~\cite{hurd2003first}---our source system---in Martin-LÃ¶f type
theory~\cite{Nordstrom-Petersson-Smith-1990}. We
formalize the subset of the \Metis inference rules for the
propositional logic fragment using a syntactical treatment.
The \Metis reasoning was formalized in
\Agda~\cite{agdateam}---our target system---in two
libraries~\cite{AgdaProp,AgdaMetis} and we implemented a
proof-reconstruction tool named \Athena~\cite{Athena} written in
\Haskell that is able to generate \Agda proof-terms for \Metis
derivations. During writing this document, our formalization helps to report two programming errors in \Metis.
A bug\footnote{Issue No.\,2 at \url{https://github.com/gilith/metis/issue/4}} in the printing of the derivation and a soundness bug\footnote{Issue No.\,4 at \url{https://github.com/gilith/metis/issue/4}} in the stripping of the goal.


This paper has been organized in the following way.  In
Section~\ref{sec:type-theory}, some limitations of type theory are
discussed from our proof-reconstruction point of view.  In
Section~\ref{sec:metis-language-and-proofs}, we introduce the \Metis
prover.  In Section~\ref{sec:proof-reconstruction}, we show our
approach to reconstruct \Metis derivations.  Related work is described in
Section~\ref{sec:related-work}.  Conclusions and suggestions for
future work are presented in Section~\ref{sec:conclusions}.

The source code accompanying this paper (programs, libraries, and
examples) is available at \verb!GitHub!:

\begin{itemize}
  \item The \Athena program that translates proofs generated by \Metis
  to \Agda code: \url{http://github.com/jonaprieto/athena}.

  \item The \verb!agda-prop! library as a formalization in \Agda for
    classical propositional logic:
  \url{http://github.com/jonaprieto/agda-prop}.

  \item The \verb!agda-metis! library as a formalization in \Agda to
  justify \Metis derivations of classical propositional logic:
  \url{http://github.com/jonaprieto/agda-prop}.

\end{itemize}


The proof-reconstruction tool \Athena was tested with \prg{GHC}~8.2.1.
Both libraries, \verb!agda-prop! and \verb!agda-metis! were tested with
\Agda~2.5.3 and \Agda standard library~0.14.
\Athena jointly with \verb!agda-prop! and \verb!agda-metis! are able to reconstruct propositional proofs of \Metis~2.3 (release~20171021).
We successfully reconstruct around eighty theorems in classical propositional logic from the \TPTP
collection~\cite{Prieto-Cubides2017}.


\end{document}
