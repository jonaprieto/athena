\documentclass[../../main.tex]{subfiles}
\begin{document}

\subsubsection{Simplification.}
\label{sssec:simplify}

The \simplify rule is an inference that performs simplification of
definitions and tautologies. This rule
transverses a list of previous derivations by applying different theorems
(e.g., \emph{modus pones}, \emph{modus tollens}, or \emph{disjunctive
syllogism}) to get a contradiction in the first place, or a smaller
convenient formula.

We observe based on the analysis of different
cases in \TSTP derivation that \simplify can be modeled by a binary function.
As we see in~(\ref{eq:simplify-1}), if \fsimplify gets ⊥
from its input derivations, it derives ⊥, and the same occurs with ⊤.
Otherwise, in~(\ref{eq:simplify-2}) \fsimplify performs an analysis by cases
to determine which theorem applies.

 \begin{equation}
  \label{eq:simplify-1}
  \begin{aligned}
  &\hspace{.495mm}\fsimplify : \Prop → \Prop → \Prop → \Prop\hspace*{3.5cm}\\
  &\begin{array}{ll}
   \fsimplify~⊥~φ₂~ψ  &=⊥\\
   \fsimplify~φ₁~⊥~ψ  &=⊥\\
   \fsimplify~φ₁~φ₂~ψ &=⊥\\
   \fsimplify~φ₁~φ₂~⊤ &=⊤
  \end{array}
  \end{aligned}
  \end{equation}

For $i,\, j = 1, 2$, $i\neq j$ and $γ : \Prop$,
\begin{equation}
  \label{eq:simplify-2}
  \begin{aligned}
  \begin{array}{ll}
   \fsimplify~φ₁~φ₂~ψ &=
      \begin{cases}
        ψ,          &\text{ if }φᵢ ≡ ψ\\
        γ,          &\text{ if }φᵢ ≡ φⱼ ⇒ γ\\
        γ,          &\text{ if }φᵢ ≡ γ ⇒ \fnnf~¬ φⱼ\\
        γ,          &\text{ if }φᵢ ≡ (\fnnf¬ φⱼ) ∨ γ\\
        ⊥,          &\text{ if } \fnnf~¬ φⱼ ≡ \fconjunct~φᵢ~(\fnnf~¬ φⱼ)\\
      % φ          &\text{ if }\fconjunct(nnf(¬ φᵢ), φⱼ) ≡  φⱼ\\
        ⊥,          &\text{ if } ¬ φⱼ ≡ \fcanonicalize~φᵢ~¬φⱼ \\
        φ₁,         &\text{ otherwise.}
      \end{cases}
  \end{array}
  \end{aligned}
  \end{equation}


\begin{mainth}[thm-simplify] % (fold)
  \label{thm:simplify}
For $i=1,\, 2, \cdots, n$, $Γ ⊢ φᵢ$ and $ψ : \Prop$ then
if $n > 2$, $Γ ⊢ \fsimplify~γ_{n-2}~φ_{n}~ψ$ where $γ_{i} = \fsimplify~φ_{i}~φ_{i+1}~ψ$
else $Γ ⊢ \fsimplify~φ₁~φ₂~ψ$.
\end{mainth}


\begin{myremark}
Besides the fact that $\List\ \Prop \to \Prop$ is the type that coincides
with the \simplify rule in \TSTP derivations, we choose a different
option. In the translation from \TSTP to \Agda, we take the list of
derivations and use a classical left folding ($\rm{foldl}$) with
$\fsimplify$ function over the list of $φ₁, φ₂, \cdots, φₙ$
that avoids us to define a new sequent type to
support \List \Prop type in the conclusion side.
\end{myremark}

\begin{myexample}
Let us review the following \TSTP excerpt where \simplify was used two times.

\begin{verbatim}
fof(norm1, g | (~ a & k), inf(conjunct, [norm0])).
fof(norm2, ~ g | q, inf(conjunct, [norm0])).
fof(norm3, ~ q, inf(conjunct, [norm0])).
fof(norm4, ~ g, inf(simplify, [norm2, norm3])).
fof(norm5, ~ k, inf(conjunct, [norm0])).
fof(norm6, $false, inf(simplify, [norm1, norm4, norm5])).
\end{verbatim}

\begin{enumerate}
\item The \simplify rule derives \verb!(~ g)! in \verb!norm2!
from \verb!norm2! and \verb!norm3! derivations using the fourth case
in~(\ref{eq:simplify-2}).
$$\fsimplify~(\neg g \vee q)~(\neg q) (\neg g) = \neg g.$$
\begin{verbatim}
fof(norm2, ~ g | q, inf(conjunct, [norm0])).
fof(norm3, ~ q,     inf(conjunct, [norm0])).
fof(norm4, ~ g,     inf(simplify, [norm2, norm3])).
\end{verbatim}
\item To derive \verb!$false! in \verb!norm6! using
Theorem~\ref{thm:simplify} we get the following proof.

\begin{equation*}
\begin{bprooftree}
\AxiomC{$\Gamma \vdash g \vee (\neg a \wedge k)$}
\AxiomC{$\Gamma \vdash\neg g$}
\RightLabel{Thm.~\ref{thm:simplify}}
\BinaryInfC{$\Gamma \vdash \neg a \wedge k$}
\AxiomC{$\Gamma \vdash \neg k$}
\RightLabel{Thm.~\ref{thm:simplify}}
\BinaryInfC{$\bot$}
\end{bprooftree}
\end{equation*}

\begin{verbatim}
fof(norm1, g | (~ a & k), inf(conjunct, [norm0])).
fof(norm4, ~ g, inf(simplify, [norm2, norm3])).
fof(norm5, ~ k, inf(conjunct, [norm0])).
fof(norm6, $false, inf(simplify, [norm1, norm4, norm5])).
\end{verbatim}
\end{enumerate}
\end{myexample}


% subsubsection simplify (end)
% -------------------------------------------------------------------

\end{document}
