\documentclass[../../main.tex]{subfiles}
\begin{document}

\subsubsection{Simplification.}
\label{sssec:simplify}

The \simplify rule is an inference that performs simplification of
definitions and tautologies. This rule
transverses a list of previous derivations by applying different theorems
(e.g., \emph{modus pones}, \emph{modus tollens}, or \emph{disjunctive
syllogism}) to get a contradiction in the first place, or a
a new formula to use later.

We observe based on the analysis of different
cases in the \TSTP derivations that \simplify can be modeled by
function with three arguments: two source formulas and the target formula.
As we see in~\eqref{eq:simplify-1}, if \fsimplify gets ⊥
from its input derivations, it derives ⊥, and the same occurs with ⊤.
Otherwise, in~\eqref{eq:simplify-2} \fsimplify performs an analysis by cases
to determine which theorem applies.

 \begin{equation}
  \label{eq:simplify-1}
  \begin{aligned}
  &\hspace{.495mm}\fsimplify : \Source → \Source → \Target → \Prop\hspace*{3.5cm}\\
  &\begin{array}{ll}
   \fsimplify~⊥~φ~ψ  &=⊥\\
   \fsimplify~φ~⊥~ψ  &=⊥\\
   \fsimplify~φ₁~φ₂~ψ &=⊥\\
   \fsimplify~φ₁~φ₂~⊤ &=⊤
  \end{array}
  \end{aligned}
  \end{equation}

For $i,\, j = 1, 2$, $i\neq j$ and $γ : \Prop$,
\begin{equation}
  \label{eq:simplify-2}
  \begin{aligned}
  \begin{array}{ll}
   \fsimplify~φ₁~φ₂~ψ &=
      \begin{cases}
        ψ,          &\text{ if }φᵢ ≡ ψ\\
        γ,          &\text{ if }φᵢ ≡ φⱼ ⇒ γ\\
        γ,          &\text{ if }φᵢ ≡ γ ⇒ \fnnf~(¬ φⱼ)\\
        γ,          &\text{ if }φᵢ ≡ (\fnnf¬ φⱼ) ∨ γ\\
        ⊥,          &\text{ if } \fnnf~(¬ φⱼ) ≡ \fconjunct~φᵢ~(\fnnf~(¬ φⱼ))\\
      % φ          &\text{ if }\fconjunct(nnf(¬ φᵢ), φⱼ) ≡  φⱼ\\
        ⊥,          &\text{ if } (¬ φⱼ) ≡ \fcanonicalize~φᵢ~(¬φⱼ) \\
        φ₁,         &\text{ otherwise.}
      \end{cases}
  \end{array}
  \end{aligned}
  \end{equation}


\begin{mainth}
  \label{thm:simplify}
For $i=1,\, 2, \cdots, n$, $Γ ⊢ φᵢ$ and $ψ : \Target$ then
if $n > 2$, $Γ ⊢ \fsimplify~γ_{n-2}~φ_{n}~ψ$ where $γ_{i} = \fsimplify~φ_{i}~φ_{i+1}~ψ$
else $Γ ⊢ \fsimplify~φ₁~φ₂~ψ$.
\end{mainth}

\begin{myremark}
Besides the fact that $\List\ \Prop \to \Prop$ is the type that most
fit with the \simplify rule in \TSTP derivations, we choose a different
option. In the translation from \TSTP to \Agda, we take the list of
derivations and use a classical left folding ($\rm{foldl}$) with
$\fsimplify$ function over the list of $φ₁, φ₂, \cdots, φₙ$
that avoids us to define a new theorem type to
support \List \Prop type in the conclusion side.
\end{myremark}


\begin{myexample}
Let us review the following \TSTP excerpt where \simplify was used two times.

\begin{verbatim}
fof(n0, (¬ p ∨ q) ∧ ¬ r ∧ ¬ q ∧ (p ∨ (¬ s ∨ r)), ...
fof(n1, p ∨ (¬ s ∨ r), inf(conjunct, [n0])).
fof(n2, ¬ p ∨ q, inf(conjunct, [n0])).
fof(n3, ¬ q, inf(conjunct, [n0])).
fof(n4, ¬ p, inf(simplify, [n2, n3])).
fof(n5, ¬ r, inf(conjunct, [n0])).
fof(n6, ⊥, inf(simplify, [n1, n4, n5])).
\end{verbatim}

\begin{enumerate}
\item The \simplify rule derives \verb!¬ p! in \verb!n4!
from \verb!n2! and \verb!n3! derivations using the fourth case
in~\eqref{eq:simplify-2}, that is,

$$\fsimplify~(¬ p ∨ q)~(¬ q) (¬ p) = ¬ p.$$
% \begin{verbatim}
% fof(norm2, ¬ p ∨ q, inf(conjunct, [norm0])).
% fof(norm3, ¬ q, inf(conjunct, [norm0])).
% fof(norm4, ¬ p, inf(simplify, [norm2, norm3])).
% \end{verbatim}
\item To derive \verb!⊥! in \verb!n6! using
Theorem~\ref{thm:simplify} we get the following proof.

\begin{equation*}
\begin{bprooftree}
\AxiomC{$Γ ⊢ p ∨ (¬ s ∧ r)$}
\AxiomC{$Γ ⊢ ¬ p$}
\RightLabel{Theorem~\ref{thm:simplify}}
\BinaryInfC{$Γ ⊢ ¬ s ∧ r$}
\AxiomC{$Γ ⊢ ¬ r$}
\RightLabel{Theorem~\ref{thm:simplify}}
\BinaryInfC{$Γ ⊢ ⊥$}
\end{bprooftree}
\end{equation*}

% \begin{verbatim}
% fof(n1, g ∨ (¬ s ∧ r), inf(conjunct, [n0])).
% fof(n4, ¬ p, inf(simplify, [n2, n3])).
% fof(n5, ¬ r, inf(conjunct, [n0])).
% fof(n6, ⊥, inf(simplify, [n1, n4, n5])).
% \end{verbatim}
\end{enumerate}
\end{myexample}


% subsubsection simplify (end)
% -------------------------------------------------------------------

\end{document}
